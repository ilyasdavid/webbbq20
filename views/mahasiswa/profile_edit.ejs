<%- include ../templates/adminlte/header-nav.ejs %>
<%- include ../templates/adminlte/sidebar_mahasiswa.ejs %>
<!-- Full Width Column -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->

    <section class="content-header">
        <h1> Profile Mahasiswa </h1>
        <ol class="breadcrumb">
            <li><a href="/mahasiswa"><i class="fa fa-home"></i> Home</a></li>
            <li class="active"><a href="/mahasiswa/profile/<%= user.id %>">Profile</a></li>
            <li class="active">Edit Profile</li>
        </ol>
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="row">
            <!-- left column -->
            <div class="col-md-7">
                <div class="box box-info">
                    <div class="box-header with-border">
                        <div class="pull-left">

                            <strong> Edit Profile </strong>

                        </div>
                    </div><!-- /.box-header -->

                    <div class="box-body">
                        <!-- form edit mahasiswa -->
                        <form class="form-horizontal" action="/mahasiswa/profile/edit/<%= user.id %>" method="post" enctype="multipart/form-data">
                            <div class="box-body">
                                <!-- NPM -->
                                <div class="form-group">
                                    <label for="inputNpm" class="col-sm-2 control-label">NPM</label>
                                    <div class="col-sm-10">
                                        <input required name="npm" type="text" class="form-control" id="inputNpm"
                                            placeholder="NPM" value="<%= mahasiswa.npm %>" />
                                    </div>
                                </div>
                                <!-- Username -->
                                <div class="form-group">
                                    <label for="inputUsername" class="col-sm-2 control-label">Username</label>
                                    <div class="col-sm-10">
                                        <input required name="username" type="text" class="form-control"
                                            id="inputUsername" placeholder="Username"
                                            value="<%= mahasiswa.User.username %>" />
                                    </div>
                                </div>
                                <!-- Nama -->
                                <div class="form-group">
                                    <label for="inputNama" class="col-sm-2 control-label">Nama</label>

                                    <div class="col-sm-10">
                                        <input required name="nama" type="text" class="form-control" id="inputNama"
                                            placeholder="Nama" value="<%= mahasiswa.nama %>" />
                                    </div>
                                </div>
                                <!-- Foto -->
                                <div class="form-group">
                                    <label for="inputFoto" class="col-sm-2 control-label">
                                        Foto
                                    </label>                    
                                    <div class="col-sm-10">
                                        <input                                            
                                            name="foto"
                                            type="file"
                                            class="form-control"
                                            id="inputFoto"
                                        />
                                        <% if (mahasiswa.foto) { %>
                                            <small> Foto masih tersimpan dengan nama : <strong><%= mahasiswa.foto %></strong></small>
                                        <% } %>
                                    </div>
                                </div>
                                <!-- Jenis Kelamin -->
                                <div class="form-group">
                                    <label for="inputJenisKelamin" class="col-sm-2 control-label">Jenis
                                        Kelamin</label>

                                    <div class="col-sm-10">
                                        <select required name="jenisKelamin" class="form-control">
                                            <option value="<%= mahasiswa.jenisKelamin %>">---
                                                <%= mahasiswa.jenisKelamin %> ---</option>
                                            <option value="Pria">Pria</option>
                                            <option value="Wanita">Wanita</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="inputAlamat" class="col-sm-2 control-label">Alamat</label>
                                    <div class="col-sm-10">
                                        <input required name="alamat" type="text" class="form-control" id="inputAlamat"
                                            placeholder="Alamat" value="<%= mahasiswa.alamat %>" />
                                    </div>
                                </div>
                                <!-- DatePicker Tanggal Lahir -->
                                <div class="form-group">
                                    <label for="inputDatepickerTglLahir" class="col-sm-2 control-label">Tanggal
                                        Lahir</label>
                                    <div class="col-sm-10">
                                        <div class="input-group date">
                                            <div class="input-group-addon">
                                                <i class="fa fa-calendar"></i>
                                            </div>
                                            <input type="date" required name="tglLahir" class="form-control pull-right"
                                                id="inputDatepickerTglLahir" value="<%= mahasiswa.tglLahir %>" />
                                        </div>
                                    </div>
                                </div>
                                <!-- Jurusan -->
                                <div class="form-group">
                                    <label for="inputJurusan" class="col-sm-2 control-label">Jurusan</label>

                                    <div class="col-sm-10">
                                        <select required name="JurusanId" class="form-control">
                                            <!-- Sementara ini manual nanti diambil dari table jurusan -->
                                            <option value=<%= mahasiswa.JurusanId %>>---
                                                <%= mahasiswa.Jurusan.namaJurusan %> ---</option>
                                            <% for(let i = 0; i < jurusans.length; i++) { %>
                                            <option value=<%= jurusans[i].id %>><%= jurusans[i].namaJurusan %>
                                            </option>
                                            <% } %>
                                        </select>
                                    </div>
                                </div>
                                <!-- Membaca Al Quran -->
                                <div class="form-group">
                                    <label for="inputBacaanAlquran" class="col-sm-2 control-label">Membaca Al
                                        Quran</label>

                                    <div class="col-sm-10">
                                        <select required name="bacaQuran" class="form-control">
                                            <option value="<%= mahasiswa.bacaQuran %>">---
                                                <%= mahasiswa.bacaQuran %> ---</option>
                                            <option value="Belum Bisa">Belum Bisa</option>
                                            <option value="Belum Lancar">Belum Lancar</option>
                                            <option value="Lancar">Lancar</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- No. HP -->
                                <div class="form-group">
                                    <label for="inputNoHp" class="col-sm-2 control-label">No. HP</label>

                                    <div class="col-sm-10">
                                        <input required name="nomorHp" type="text" class="form-control" id="inputNoHp"
                                            value="<%= mahasiswa.nomorHp %>" />
                                    </div>
                                </div>
                                <!-- Email -->
                                <div class="form-group">
                                    <label for="inputEmail" class="col-sm-2 control-label">Email</label>

                                    <div class="col-sm-10">
                                        <input required name="email" type="email" class="form-control" id="inputEmail"
                                            value="<%= mahasiswa.User.email %>" />
                                    </div>
                                </div>
                                <!-- Kelas -->
                                <div class="form-group">
                                    <label for="inputKelas" class="col-sm-2 control-label">Kelas</label>

                                    <div class="col-sm-10">
                                        <select required name="KelasId" class="form-control">
                                            <option value=<%= mahasiswa.KelasId %>>---
                                                <%= mahasiswa.Kela.namaKelas %> ---</option>
                                            <% for(let i = 0; i < kelas.length; i++) { %>
                                            <option value=<%= kelas[i].id %>> <%= kelas[i].namaKelas %></option>
                                            <% } %>
                                        </select>
                                    </div>
                                </div>
                                <!-- Dosen -->
                                <div class="form-group">
                                    <label for="inputDosen" class="col-sm-2 control-label">Dosen</label>

                                    <div class="col-sm-10">
                                        <select required name="DosenId" class="form-control">
                                            <option value=<%= mahasiswa.DosenId %>>--- <%= mahasiswa.Dosen.nama %>
                                                ---</option>
                                            <% for(let i = 0; i < dosens.length; i++) { %>
                                            <option value=<%= dosens[i].id %>><%= dosens[i].nama %></option>
                                            <% } %>
                                        </select>
                                    </div>
                                </div>
                                <!-- Jadwal Kosong -->
                                <div class="form-group">
                                    <label for="inputJadwalKosong" class="col-sm-2 control-label">Jadwal
                                        Kosong</label>

                                    <div class="col-sm-10">
                                        <select required name="jadwalKosong" class="form-control">
                                            <option value="<%= mahasiswa.jadwalKosong %>">---
                                                <%= mahasiswa.jadwalKosong %> ---</option>
                                            <option value="1a">Senin, pukul 09.00</option>
                                            <option value="1b">Senin, pukul 11.00</option>
                                            <option value="1c">Senin, pukul 15.00</option>
                                            <option value="1d">Senin, pukul 17.00</option>
                                            <option value="1e">Senin, pukul 20.00</option>
                                            <option value="2a">Selasa, pukul 09.00</option>
                                            <option value="2b">Selasa, pukul 11.00</option>
                                            <option value="2c">Selasa, pukul 15.00</option>
                                            <option value="2d">Selasa, pukul 17.00</option>
                                            <option value="2e">Selasa, pukul 20.00</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- End Form -->
                            </div>
                            <!-- /.box-body -->
                            <div class="box-footer">
                                <button type="submit" class="btn btn-primary">
                                    Simpan
                                </button>
                            </div>
                            <!-- /.box-footer -->
                        </form>
                    </div><!-- /.col md-7 -->
                </div><!-- /.row -->
            </div><!-- /.box-body -->
            <!-- right column -->
            <div class="col-md-5">
                <div class="box box-danger">
                    <div class="box-header with-border">
                        <div class="pull-left">
                            <strong> Ubah Password </strong>
                        </div>
                    </div><!-- /.box-header -->
                    <div class="box-body">
                        <form class="form-vertical" action="/mahasiswa/profile/edit-password/<%= user.id %>"
                            method="post">
                            <!-- New Password -->
                            <div class="form-group">
                                <label for="inputPassword">New Password </label>
                                <div>
                                    <input type="password" class="form-control" name="password" id="password"
                                        placeholder="Password" required>
                                    <span toggle="#password-field1"
                                        class="fa fa-fw fa-eye field-icon-eye toggle-password1"></span>
                                </div>
                            </div>
                            <!-- New Password Confirmation -->
                            <div class="form-group">
                                <label for="inputPassword"> Confirm Password </label>
                                <div>
                                    <input type="password" class="form-control" name="passwordConfirm"
                                        id="passwordConfirm" placeholder="Confirm Password" required>
                                    <span toggle="#password-field2"
                                        class="fa fa-fw fa-eye field-icon-eye toggle-password2"></span>
                                </div>
                            </div>
                    </div>
                    <div class="box-footer">
                        <button type="submit" class="btn btn-primary" onclick="return Validate()">
                            Ubah
                        </button>
                    </div>
                    </form>
                </div>
            </div>
        </div>
</div>
</section>
</div>
<!-- /.content-wrapper -->
<%- include ../templates/adminlte/footer.ejs %>
<script type="text/javascript">
    function Validate() {
        let password = document.getElementById("password").value;
        let passwordConfirm = document.getElementById("passwordConfirm").value;
        if (password !== "" && passwordConfirm !== "") {
            if (password !== passwordConfirm) {
                swal({
                    title: "Not Match!",
                    text: "Your Password Confirmation Not Match!",
                    icon: "warning",
                    button: "Oke",
                });
                return false;
            } else {
                console.log('Oke Sama');
                return true;
            }
        }
    }

    $(".toggle-password1").click(function () {
        $(this).toggleClass("fa-eye fa-eye-slash");
        let inputPasswordType = $('#password')
        if (inputPasswordType.attr('type') === "password") {
            inputPasswordType.attr('type', 'text');
        } else {
            inputPasswordType.attr('type', 'password');
        }
    });

    $(".toggle-password2").click(function () {
        $(this).toggleClass("fa-eye fa-eye-slash");
        let inputPasswordConfirmType = $('#passwordConfirm')
        if (inputPasswordConfirmType.attr('type') === "password") {
            inputPasswordConfirmType.attr('type', 'text');
        } else {
            inputPasswordConfirmType.attr('type', 'password');
        }
    });
</script>